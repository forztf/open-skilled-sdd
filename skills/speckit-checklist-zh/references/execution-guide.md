# 执行指南

## 完整执行步骤详解

### 1. 环境设置
运行先决条件检查脚本：
```powershell
.scripts\check-prerequisites.ps1 -Json
```

**解析输出：**
- `FEATURE_DIR`: 功能根目录的绝对路径
- `AVAILABLE_DOCS`: 可用文档列表 [spec.md, plan.md, tasks.md]

### 2. 动态意图澄清算法

**信号提取：**
1. 功能域关键词：auth, latency, UX, API
2. 风险指标：critical, must, compliance
3. 利益相关者提示：QA, review, security team
4. 明确交付物：a11y, rollback, contracts

**问题生成原型：**
- 范围细化："这应该包括与X和Y的集成接触点还是仅限于本地模块正确性？"
- 风险优先级："这些潜在风险区域中哪些应该接受强制性门控检查？"
- 深度校准："这是轻量级预提交健全性列表还是正式发布门？"
- 受众框架："这仅供作者使用还是在PR审查期间供同行使用？"
- 边界排除："本轮我们是否应明确排除性能调优项目？"

### 3. 上下文加载策略

**渐进式披露原则：**
- 仅加载与活动焦点区域相关的必要部分
- 优先将长部分总结为简洁的场景/需求要点
- 使用渐进式披露：仅在检测到缺失时添加后续检索
- 如果源文档很大，生成临时摘要项目而不是嵌入原始文本

### 4. 检查清单生成算法

**核心原则 - 测试需求而非实施：**
每个检查清单项目必须评估需求本身在以下方面的质量：
- **完整性**：是否存在所有必要的需求？
- **清晰度**：需求是否明确无歧义？
- **一致性**：需求是否相互一致？
- **可测量性**：需求是否可以客观验证？
- **覆盖度**：是否处理了所有场景/边界情况？

**可追溯性要求：**
- 最低要求：≥80%的项目必须包含至少一个可追溯性引用
- 每个项目应引用：规范章节 [Spec §X.Y]，或使用标记：[Gap], [Ambiguity], [Conflict], [Assumption]
- 如果不存在ID系统："是否建立了需求和验收标准ID方案？[可追溯性]"

### 5. 内容整合策略

**软上限：** 如果原始候选项目 > 40，按风险/影响优先排序
**合并重复项：** 合并检查相同需求方面的近似重复项
**边界情况分组：** 如果 > 5 个低影响边界情况，创建一个项目："需求中是否解决了边界情况X, Y, Z？[覆盖度]"